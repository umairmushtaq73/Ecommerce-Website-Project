{% extends "base.html" %}

{% block title %}Orders - ShopEasy{% endblock %}

{% block content %}
<div class="orders-section">
    <h2 class="section-title">
        <i class="fas fa-receipt"></i> Order History
    </h2>

    {% if orders %}
    <div class="orders-grid">
        {% for order in orders %}
        <div class="order-card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <div>
                    <h3 style="font-size: 1.1rem; color: var(--primary);">
                        Order #{{ order.order_id }}
                    </h3>
                    <p style="color: var(--gray); font-size: 0.875rem;">
                        <i class="far fa-calendar"></i> {{ order.date }}
                    </p>
                </div>
                <span style="padding: 0.5rem 1rem; background: #d1fae5; color: #065f46; 
                             border-radius: 20px; font-weight: 600; font-size: 0.875rem;">
                    {{ order.status }}
                </span>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <p style="margin-bottom: 0.5rem;">
                    <i class="fas fa-user"></i> {{ order.customer_name }}
                </p>
                <p style="color: var(--gray); font-size: 0.875rem;">
                    <i class="fas fa-envelope"></i> {{ order.email }}
                </p>
            </div>
            
            <!-- FIXED BLOCK BELOW -->
            <div style="margin-bottom: 1.5rem;">
                <h4 style="font-size: 0.9rem; margin-bottom: 0.5rem; color: var(--dark);">
                    <i class="fas fa-box"></i> Items Ordered
                </h4>

                <ul style="list-style: none; padding-left: 0;">
                    {% for item in order["items"] %}
                    <li style="padding: 0.5rem 0; border-bottom: 1px solid var(--gray-light);">
                        {{ item["name"] }} - ${{ "%.2f"|format(item["price"]) }} x {{ item["quantity"] }}
                    </li>
                    {% endfor %}
                </ul>
            </div>
            <!-- FIXED BLOCK ENDS -->

            <div style="display: flex; justify-content: space-between; align-items: center; 
                        padding-top: 1rem; border-top: 2px solid var(--gray-light);">
                <div>
                    <p style="font-size: 0.875rem; color: var(--gray);">Total Amount</p>
                    <p style="font-size: 1.5rem; font-weight: 700; color: var(--primary);">
                        ${{ "%.2f"|format(order.total) }}
                    </p>
                </div>
                <button style="padding: 0.5rem 1rem; background: var(--primary); color: white; 
                              border: none; border-radius: var(--radius); cursor: pointer;">
                    <i class="fas fa-print"></i> View Details
                </button>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-cart">
        <h2><i class="fas fa-receipt"></i> No Orders Yet</h2>
        <p>You haven't placed any orders. Start shopping to see your order history here.</p>
        <a href="{{ url_for('index') }}" class="btn btn-primary">
            <i class="fas fa-shopping-bag"></i> Start Shopping
        </a>
    </div>
    {% endif %}
</div>

<style>
.orders-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 2rem;
    margin-top: 2rem;
}

.order-card {
    background: white;
    padding: 1.5rem;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    transition: var(--transition);
}

.order-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-lg);
}
</style>
{% endblock %}
